---
title: "Ingalls Standards Project: Structural Changes"
author: "R.Lionheart"
date: "Start date: 3/17/2020"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("src/Functions.R")

library(stringr)
library(tidyverse)
```

This markdown document controls the original large structural changes initiated at the beginning of the repository (March 2020). "Large Structural Changes" include the creation of new columns, multi-group name changes of compounds, etc.
------

```{r Source Primary ID code, include=TRUE}
matching.variable = "Ingalls"
filenames <- RemoveCsv(list.files(path = "data_raw", pattern = matching.variable))

for (i in filenames) {
  filepath <- file.path("data_raw", paste(i, ".csv", sep = ""))
  assign(make.names(i), read.csv(filepath, stringsAsFactors = FALSE, fileEncoding = "latin1"))
}

source("src/Primary_ID.R")

write.csv(Ingalls_Lab_Standards_Extras, "Ingalls_Lab_Standards_NEW.csv")

```

```{r Source Figures Names code, include=TRUE}

source("src/Figure_Names.R")

write.csv(Ingalls_Lab_Standards_FigNames, "Ingalls_Lab_Standards_NEW.csv")
```

-----

```{r Source ChEBI code, include=TRUE}

source("src/CHEBI_check.R")

write.csv(Ingalls_Lab_Standards_ChEBI, "Ingalls_Lab_Standards_NEW.csv")
```

-----

```{r Source IUPAC, InCHI, and SMILES code, include=TRUE}

source("src/IUPAC_InChl_Smiles.R")

write.csv(Ingalls_Lab_Standards_IUPAC.InCHI.SMILES, "Ingalls_Lab_Standards_NEW.csv")
```

-----

The next section deals with the ClassyFire ID section. 
The source code for creating the ClassyFire IDs commented out: *DO NOT RUN THE High Class Function LINE UNLESS YOU ARE STARTING THE PROJECT FROM SCRATCH!!* It can take several hours just to complete.

```{r Source Classyfire code, include=TRUE}

### source("src/High_Class_Function_062220.R") ###
source("src/Classyfire_column.R")

Ingalls_Lab_Standards_Classyfire$m.z <- sub("188.055899Ã‚", "188.055899",
                                            Ingalls_Lab_Standards_Classyfire$m.z)

write.csv(Ingalls_Lab_Standards_Classyfire, "Ingalls_Lab_Standards_NEW.csv", row.names = FALSE)
```

-----

```{r Source SQL-Safe code, include=TRUE}

source("src/SQL_Safe.R")
Ingalls_Lab_Standards_SQLSafe$Compound.Name_SQL <- gsub("Vit", "Vitamin", Ingalls_Lab_Standards_SQLSafe$Compound.Name_SQL)
Ingalls_Lab_Standards_SQLSafe <- Ingalls_Lab_Standards_SQLSafe %>%
  mutate(Compound.Name_SQL = recode(Compound.Name_SQL,
                                    "Vitaminamin B2 13C4 15N2" = "Vitamin B12 13C4 15N2"))

write.csv(Ingalls_Lab_Standards_SQLSafe, "Ingalls_Lab_Standards_NEW.csv", row.names = FALSE)
```

